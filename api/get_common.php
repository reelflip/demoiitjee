<?php require 'config.php'; header('Content-Type: application/json'); $res=[]; $res['quotes']=$conn->query("SELECT * FROM quotes")->fetchAll(PDO::FETCH_ASSOC); $res['notifications']=$conn->query("SELECT * FROM notifications ORDER BY created_at DESC")->fetchAll(PDO::FETCH_ASSOC); $res['flashcards']=$conn->query("SELECT * FROM flashcards")->fetchAll(PDO::FETCH_ASSOC); $res['hacks']=$conn->query("SELECT * FROM memory_hacks")->fetchAll(PDO::FETCH_ASSOC); $res['blogPosts']=$conn->query("SELECT id, title, excerpt, content, author, category, image_url as imageUrl, created_at as date FROM blog_posts ORDER BY created_at DESC")->fetchAll(PDO::FETCH_ASSOC); $ts=$conn->query("SELECT * FROM tests")->fetchAll(PDO::FETCH_ASSOC); foreach($ts as &$t){ $t['questions']=$conn->query("SELECT * FROM questions q JOIN test_questions tq ON q.id=tq.question_id WHERE tq.test_id='{$t['id']}' ORDER BY tq.question_order")->fetchAll(PDO::FETCH_ASSOC); foreach($t['questions'] as &$q){ $q['options']=json_decode($q['options_json']); } } $res['tests']=$ts; echo json_encode($res);